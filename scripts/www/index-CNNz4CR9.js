import{r as g,z as E,h as F,b as m,d as a,l as t,t as h,Q as T,g as d,F as y,i as B,M as j,u as U,E as P,H as G,o as v,R as V,J as x,L as Z,K as Y}from"./.pnpm-B-_m2kGH.js";import{_ as H}from"./navBar-Sc4C80VW.js";import{l as K}from"./Group 24-BJuc7rVH.js";import{g as z}from"./index-4hp_MxG3.js";import{q as W,c as X,a as O}from"./index-By4LL1XK.js";import{u as $}from"./station-DOwaTfnq.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-C1_hm9C_.js";import"./index-DyucNCMT.js";const te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAA4pJREFUWEfVmd9LFFEUx79ntgiiwN1S1qXIKB8qMRJJCKTUfhIFhmZqPfQQ+dBDhA/qH1A9CPXQg9FDD5VmSkIRSaYWQlFIZFhBJGXE7qa4W1QQ4cyJu7vjjvvTmdmuOk+7c+4953PPPXPmzD2EFJcvyHnEqNUY5QQUgJANwJFqjgWZCsYEA28VQj8UdLqz6FMyPZRI4A3yOtLQCsIRAIoFCDtTNDDukAMticDjgL0BridGGwgr7Fi1PZfxiwmnPS5qN+qaBewNcDMB520by6ACBlo8Lrqgq5wB9ga4joBbGbSVMVUMHPe4KMQWAvZ/5/Ws4s28h0GyJYrwUFDgcdJ4CNg3xR0gHMuYS/6DImZ0e1ZRNYW8q+HjPGQDs8vSQNhA/gA3MTAT1Ga1yBxPQAt5p7iPCLvtGu4dDj8Q+4rjNaWSmbHLjMfkm2IvCLlmJiYa2z4QvltXHi9NJTNll+EnX4CnM/G6lQIMqAKYTa0yyWBJwLAMrGmMr5Magj8Zqjb3JTsUwLmSsCZbgaIkLGVSKrMMPO5XMREMb46+Rbp58d+IYpTrv3OchDy3+cLPMvDL99NQ1agzYiHT+Vx4evvmJemGxcktAw+NTIfdaOMJKN0qEXjwlUgu4St/rQK3K308fgsyPnyJBnxZkUTgvuEosIBdnRULHO/+qR8s6paZhe4plgj88EUU2HQgRgL+QIlE4PvPDE+caeLwhEM7JGaJniH7wJWlEoG7ntgHrt4lEbij3z5wbYVE4BuPYoDT5eQE8hN7JQJf77Xv4ZP7JQJfexAGjnWc/j/Rfb3u0GWnDkoEbrtn38MNhyUCX+mxD3ymUiLw5W77wGerJAK3diYBTpctDG/FxhqJwBfbI8BGwERVu/HJjKmPmmqtAVv6CL3UreL3H4tFBIDly4Bz1aaBVfGZ7wPBbdb00xENg6+tV+9l2wg7C00ePTN8lg9SxLf283caRsaAv2KPjOzJ4piApQ6gKB8o2aSA0tf8s/wYOkjxB7iZF9iZcLLdJqCZRB8DjLHFcBhICjbqx61dIFSZjWPJ42/nuqg2BBxpwowu5ANtcqBQNGmMLYN6Am5K9tqczDFQrzdnFm9TRl9qqDnDuDrv4RFuezXozRidL2EmjLQRRPvr6DxkD9FYvMsKGkUTJjZmUqZuAQ4NNRqjgoAtIORk4iw5BkK0bicZGFUIA0zoyHXS52TB/Q9bS4ptwrYjugAAAABJRU5ErkJggg==",se={class:"displayInstall"},oe={class:"card"},le={class:"card_content"},ae={class:"card_icon_content"},ne={class:"icons"},ce={class:"value"},ie={class:"card_icon_content"},re={class:"icons"},de={class:"value"},ue={class:"card_display_num"},me={class:"buttons"},ve=["onClick"],ge={class:"footer"},_e={__name:"index",setup(pe){const _=$(),w=P(),p=F(),l=g([{collectorNo:"",uid:new Date().getTime(),installScreenItemList:[{uid:new Date().getTime()+10,screenNo:""}]}]),A=g(null),N=g(null);E(()=>{q()});const q=async()=>{const n={id:p.query.id,machineNo:_.machineNo};let e=await W(n);e.code==200&&(A.value=e.data.machineNo,N.value=e.data.gatewayNo,_.gatewayNo=e.data.gatewayNo,e.data.installScreenCollectorItemList.length>0&&(l.value=e.data.installScreenCollectorItemList,l.value.forEach((s,o)=>{s.uid=new Date().getTime()+o,s.installScreenItemList&&s.installScreenItemList.length>0?s.installScreenItemList.forEach((u,c)=>{u.uid=new Date().getTime()+o+c}):s.installScreenItemList=[{uid:new Date().getTime()+o,screenNo:""}]})))},D=()=>{l.value.push({collectorNo:"",uid:new Date().getTime(),installScreenItemList:[{uid:new Date().getTime()+10,screenNo:""}]})},b=(n,e)=>{l.value[e].installScreenItemList.push({uid:new Date().getTime()+e,screenNo:""})},k=(n,e,s,o)=>{l.value[e].installScreenItemList.splice(o,1)},C=(n,e)=>{l.value.splice(e,1)},I=g(null),J=()=>{I.value.validate().then(()=>{Q()})},Q=async()=>{const n={stationId:p.query.id,machineNo:A.value,gatewayNo:N.value,screenCollectorItemList:l.value.map(c=>({collectorNo:c.collectorNo,screenNoList:c.installScreenItemList.map(f=>f.screenNo)}))},e=n.screenCollectorItemList.map(c=>c.screenNoList).flat();let s=await z(e);if((await X({deviceModel:s.data,screenNoList:e})).code!=200)return;G({message:"加载中...",forbidClick:!0}),(await O(n)).code==200&&(_.installScreenCollectorItemList=l.value,w.push({path:"feedback",query:{id:p.query.id}}))};return(n,e)=>{const s=H,o=T,u=x,c=Y,f=V,M=j;return v(),m("div",null,[a(s,{title:"显示屏安装Lua模式"}),t("div",se,[t("div",oe,[e[7]||(e[7]=t("div",{class:"card_title"},"基础数据",-1)),t("div",le,[t("div",ae,[e[2]||(e[2]=t("img",{class:"icon",src:te,alt:""},null,-1)),t("div",ne,[e[1]||(e[1]=t("div",{class:"label"},"路由器编号",-1)),t("div",ce,h(N.value),1)])]),t("div",ie,[e[4]||(e[4]=t("img",{class:"icon",src:K,alt:""},null,-1)),t("div",re,[e[3]||(e[3]=t("div",{class:"label"},"加油机编号",-1)),t("div",de,h(A.value),1)])])]),t("div",ue,[e[5]||(e[5]=t("div",{class:"card_display_num_title"},"显示屏安装",-1)),t("div",me,[a(o,{name:"plus",color:"#fff"}),t("div",{class:"font",onClick:D},"添加采集器")])]),a(M,{ref_key:"formRef",ref:I,class:"form"},{default:d(()=>[(v(!0),m(y,null,B(l.value,(r,L)=>(v(),m("div",{class:"item",key:r.uid},[a(f,null,{right:d(()=>[a(c,{square:"",text:"删除",type:"danger",class:"delete-button",style:{height:"100%"},onClick:i=>C(r,L)},null,8,["onClick"])]),default:d(()=>[a(u,{modelValue:r.collectorNo,"onUpdate:modelValue":i=>r.collectorNo=i,placeholder:"请输入采集器编号",rules:[{required:!0,message:"请输入采集器编号"}]},{label:d(()=>e[6]||(e[6]=[t("div",{class:"babel"},[t("span",{style:{color:"red"}},"*"),Z(" 采集器编号")],-1)])),button:d(()=>[t("div",{class:"item_button1",onClick:i=>b(r,L)},[a(o,{name:"plus",color:"#000",size:"12"})],8,ve)]),_:2},1032,["modelValue","onUpdate:modelValue"]),(v(!0),m(y,null,B(r.installScreenItemList,(i,R)=>(v(),m("div",{key:i.uid},[a(u,{modelValue:i.screenNo,"onUpdate:modelValue":S=>i.screenNo=S,required:"",label:"显示屏编号",placeholder:"请输入显示屏编号",rules:[{required:!0,message:"请输入显示屏编号"}]},{button:d(()=>[a(o,{name:"delete-o",color:"#000",size:"15",onClick:S=>k(r,L,i,R)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))]),_:2},1024)]))),128))]),_:1},512)]),t("div",ge,[t("div",{class:"btn",onClick:e[0]||(e[0]=()=>U(w).go(-1))},"上一步"),t("div",{class:"nexBtn",onClick:J},"下一步")])])])}}},Be=ee(_e,[["__scopeId","data-v-f25d5ce4"]]);export{Be as default};
