import{a1 as ue,b as c,o as u,l,$ as v,r as a,h as ie,W as ce,z as re,X as de,d as U,A as M,G as $,t as N,u as w,U as ve,J as me,g as fe,Y as ye,Z as pe,F as P,i as q,C as y,E as ge,j as B,H as _e}from"./.pnpm-B-_m2kGH.js";import{_ as ke}from"./navBar-Sc4C80VW.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{n as Ce,r as be,t as Ne}from"./index-4hp_MxG3.js";import{u as X,o as we,d as Se,a as he,b as Le}from"./index-dR22aBmx.js";import{u as xe,a as E}from"./dict-CwYOActj.js";import"./request-C1_hm9C_.js";import"./index-DyucNCMT.js";const Ue={class:"led"},$e={class:"h"},Ve={class:"h"},Fe={class:"bottom"},Ge={__name:"ledStyle",props:{defaultColor:{type:String,default:"#F5F5F5"},list:{type:Array,default:()=>[0,0,0,0,0,0,0,0]},color:{type:String,default:"#0368C2"}},setup(i){ue(p=>({"05761bbc":i.defaultColor}));const t=i;return(p,A)=>(u(),c("div",Ue,[l("div",{class:"item",style:v({background:t.list[0]==1?t.color:i.defaultColor})},null,4),l("div",$e,[l("div",{class:"item",style:v({background:t.list[5]==1?t.color:i.defaultColor})},null,4),l("div",{class:"item right",style:v({background:t.list[1]==1?t.color:i.defaultColor})},null,4)]),l("div",{class:"item",style:v({background:t.list[6]==1?t.color:i.defaultColor})},null,4),l("div",Ve,[l("div",{class:"item",style:v({background:t.list[4]==1?t.color:i.defaultColor})},null,4),l("div",{class:"item right",style:v({background:t.list[2]==1?t.color:i.defaultColor})},null,4)]),l("div",Fe,[l("div",{class:"item",style:v({background:t.list[3]==1?t.color:i.defaultColor})},null,4),l("div",{class:"dorp",style:v({background:t.list[7]==1?t.color:i.defaultColor})},null,4)])]))}},R=Y(Ge,[["__scopeId","data-v-88e46276"]]),Me={class:"content"},Ae={class:"debugInfo"},De={key:0,class:"item net"},Ie={class:"value"},Pe={key:1,class:"item net"},qe={class:"value"},Be={class:"item net"},Ee={class:"value"},Re={class:"select-conent"},ze={key:2},Te={class:"stitch"},je={class:"code"},He={class:"code"},Je={class:"code"},Oe={__name:"index",setup(i){const t=ge(),p=ie(),A=a([]),{stitch_type:g,sys_stitch_count:z,ref_line_status:D}=xe("stitch_type","sys_stitch_count","ref_line_status"),r=a(p.query.deviceModel),_=a(p.query.collectorNo),k=a(p.query.gatewayNo),d=a(p.query.screenNo);ce(()=>{g.value.length>0&&(g.value.map(e=>e.value).forEach((e,o)=>{if(z.value.length>0){let f=z.value.filter(b=>b.label.includes(e));f=f.map(b=>({value:b.value,text:b.label})),g.value[o].text=g.value[o].label,g.value[o].children=f}}),A.value=g.value)});const Z=async()=>{let s={deviceModel:r.value,screenNo:d.value},e=await X(s);if(e.data.raiseGunPicUrl){m.value=e.data.raiseGun;let o=await we({url:e.data.raiseGunPicUrl});T.value=!1,L.value=[{url:o.data,deletable:T.value}]}},T=a(!0);re(()=>{Z()});const m=a(null),S=a(!1),h=a(""),I=a(""),K=({selectedValues:s,selectedOptions:e})=>{h.value=s[1],I.value=e[1].text,S.value=!1},Q=()=>{if(!h.value){y("请选择针脚数量");return}t.push({path:"collection",query:{pinNum:h.value,screenNo:d.value,gatewayNo:k.value,collectorNo:_.value}})},j=a([]),H=a([]),J=a([]),ee=async()=>{if(!h.value){y("请选择针脚数量");return}if(!m.value){y("请选择有无抬枪线");return}if(m.value==1&&L.value.length==0){y("请上传抬枪线图片");return}y("配置文件下发中..."),C&&(clearInterval(C),C=null);let s={deviceModel:r.value,screenNo:d.value,pinNum:h.value,gatewayNo:k.value,collectorNo:_.value};(await Ce(s)).code==200&&te(s)},le=async()=>{y("配置文件下发中...");let s={deviceModel:r.value,screenNo:d.value,gatewayNo:k.value,collectorNo:_.value},e=await he(s);e.code==200&&y(e.message)};let C=null;const V=a(0),F=a(0),G=a(0),te=s=>{C=setInterval(async()=>{let e=await Ne(s);e.code==200&&(V.value=e.data.collectorStatus,F.value=e.data.gatewayStatus,G.value=e.data.screenStatus,j.value=e.data.amountList?e.data.amountList.map(o=>Array.from(o)):[],H.value=e.data.volumeList?e.data.volumeList.map(o=>Array.from(o)):[],J.value=e.data.priceList?e.data.priceList.map(o=>Array.from(o)):[])},1e3)};de(()=>{clearInterval(C),C=null});const se=async()=>{(await be({deviceModel:r.value,screenNo:d.value,gatewayNo:k.value,collectorNo:_.value})).code==200&&t.push("/")},O=async s=>{await Se({screenNo:d.value,gatewayNo:k.value,collectorNo:_.value,type:s}),m.value=s},W=a(null),L=a([]),ae=async s=>{const e=new FormData;e.append("file",s.file),e.append("fileType","104"),W.value=_e({message:"上传中...",forbidClick:!0,duration:0}),Le(e).then(async o=>{const f={deviceModel:r.value,screenNo:d.value,raiseGunPicUrl:o.data};await X(f)}).catch(()=>{L.value=[]}).finally(()=>{W.value.close()})};return(s,e)=>{const o=ke,f=ve,b=me,oe=ye,ne=pe;return u(),c("div",null,[U(o,{title:"调试详情"}),l("div",Me,[l("div",Ae,[e[15]||(e[15]=l("div",{class:"title"},"基础信息",-1)),r.value!="0401"?(u(),c("div",De,[l("div",{class:$(["status",F.value?"":"checkStatus"])},N(F.value?w(E)(F.value,w(D)):"离线"),3),e[7]||(e[7]=l("div",{class:"label"},"路由器编号 :",-1)),l("div",Ie,N(k.value),1)])):M("",!0),r.value!="0401"?(u(),c("div",Pe,[l("div",{class:$(["status",V.value?"":"checkStatus"])},N(V.value?w(E)(V.value,w(D)):"离线"),3),e[8]||(e[8]=l("div",{class:"label"},"连接器编号 :",-1)),l("div",qe,N(_.value),1)])):M("",!0),l("div",Be,[l("div",{class:$(["status",G.value?"":"checkStatus"])},N(G.value?w(E)(G.value,w(D)):"离线"),3),e[9]||(e[9]=l("div",{class:"label"},"显示屏编号 :",-1)),l("div",Ee,N(d.value),1)]),l("div",null,[e[10]||(e[10]=l("div",{class:"isSlect"},"有无抬枪线",-1)),l("div",Re,[l("div",{onClick:e[0]||(e[0]=n=>O(1)),class:$(["select-item",m.value==1?"active":""])},"有抬枪线",2),l("div",{onClick:e[1]||(e[1]=n=>O(2)),class:$(["select-item",m.value==2?"active":""])},"无抬枪线",2)])]),m.value==1?(u(),c("div",ze,[e[11]||(e[11]=l("div",{class:"isSlect"},"抬枪线拍照记录",-1)),U(f,{"after-read":ae,"max-count":1,modelValue:L.value,"onUpdate:modelValue":e[2]||(e[2]=n=>L.value=n)},null,8,["modelValue"])])):M("",!0),l("div",Te,[U(b,{modelValue:I.value,"onUpdate:modelValue":e[3]||(e[3]=n=>I.value=n),onClick:e[4]||(e[4]=n=>S.value=!0),"is-link":"",readonly:"",label:"针脚数量",placeholder:"选择针脚数量","input-align":"right"},null,8,["modelValue"])]),U(ne,{show:S.value,"onUpdate:show":e[6]||(e[6]=n=>S.value=n),"destroy-on-close":"",round:"",position:"bottom"},{default:fe(()=>[U(oe,{columns:A.value,onCancel:e[5]||(e[5]=n=>S.value=!1),onConfirm:K},null,8,["columns"])]),_:1},8,["show"]),l("div",{class:"btn",onClick:ee},"配置文件下发"),r.value=="0401"?(u(),c("div",{key:3,class:"btn",onClick:le},"显示屏设备编号下发")):M("",!0),l("div",{class:"btn",onClick:Q},"采集率"),e[16]||(e[16]=l("div",{class:"info"},"配置文件(优先选择前面的配置文件)",-1)),e[17]||(e[17]=l("div",{class:"info",style:{"margin-bottom":"16px"}},"没有可用的配置文件",-1)),l("div",null,[e[12]||(e[12]=l("div",{class:"code_title"},"金额 :",-1)),l("div",je,[(u(!0),c(P,null,q(j.value,(n,x)=>(u(),B(R,{class:"ledStyle",list:n,key:x},null,8,["list"]))),128))])]),l("div",null,[e[13]||(e[13]=l("div",{class:"code_title"},"油量 :",-1)),l("div",He,[(u(!0),c(P,null,q(H.value,(n,x)=>(u(),B(R,{class:"ledStyle",list:n,color:"#0368C2",key:x},null,8,["list"]))),128))])]),l("div",null,[e[14]||(e[14]=l("div",{class:"code_title"},"单价 :",-1)),l("div",Je,[(u(!0),c(P,null,q(J.value,(n,x)=>(u(),B(R,{class:"ledStyle",list:n,color:"#0368C2",key:x},null,8,["list"]))),128))])])]),l("div",{class:"submit",onClick:se},"完成调试")])])}}},tl=Y(Oe,[["__scopeId","data-v-f26ec126"]]);export{tl as default};
