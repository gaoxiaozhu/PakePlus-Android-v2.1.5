import{r as e,z as q,b as l,d as r,l as c,g as m,F as E,i as M,u as s,B as g,N as U,a4 as A,a5 as F,L as C,D as P,h as $,E as j,o as d,t as w,q as G,A as x}from"./.pnpm-B-_m2kGH.js";import{_ as O}from"./navBar-Sc4C80VW.js";import{i as Q,a as T}from"./index-Bxo7U9o_.js";import{u as H}from"./station-DOwaTfnq.js";import{u as J,a as K}from"./dict-CwYOActj.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-C1_hm9C_.js";import"./index-DyucNCMT.js";const X={class:"patrol-list"},Z={class:"list"},tt=["onClick"],ot={class:"itemn-left"},st={class:"title"},at={class:"item-right"},et={key:0,class:"span"},nt={key:1},it={class:"dialogBox"},lt={__name:"patrol-list",setup(rt){const u=H().stationId,{inspection_type:D}=J("inspection_type"),I=()=>{h.replace("addEquipment")};$();const h=j(),n=e(!1),y=e(!1),i=e([]),L=()=>{f.value={pageSize:10,pageNum:1,stationId:u}},k=e(0),f=e({pageSize:10,pageNum:1,stationId:u}),v=async()=>{try{n.value=!0;const a=await Q(f.value);i.value=[...i.value,...a.data.list],k.value=a.data.total,f.value.pageNum+=1,i.value.length>=k.value&&(y.value=!0)}catch(a){console.error("分页请求失败:",a)}finally{n.value=!1}},p=e(!1),_=e(1),N=()=>{p.value=!0},S=async()=>{await T({stationId:u,type:_.value}),i.value=[],L(),v()},R=a=>{h.push({name:"patrolInfo",query:{id:u,inspectionInfoId:a.id}})};return q(()=>{v()}),(a,o)=>{const V=U,B=F,z=A,Y=P;return d(),l("div",X,[r(O,{title:"巡检记录","right-text":"新增",onClickRight:N,onClickLeft:I}),c("div",Z,[r(V,{loading:s(n),"onUpdate:loading":o[0]||(o[0]=t=>g(n)?n.value=t:null),finished:s(y),"finished-text":"没有更多了",onLoad:v,"immediate-check":!1},{default:m(()=>[(d(!0),l(E,null,M(s(i),(t,b)=>(d(),l("div",{class:"item",key:b,onClick:dt=>R(t)},[c("div",ot,[c("span",st,w(s(K)(t.type,s(D))),1),C(" 日期: "+w(s(G)(t.installationDate).format("YYYY-MM-DD")),1)]),c("div",at,[t.status?(d(),l("span",et)):x("",!0),t.status?(d(),l("div",nt,"已签字")):x("",!0)])],8,tt))),128))]),_:1},8,["loading","finished"])]),r(Y,{show:s(p),"onUpdate:show":o[2]||(o[2]=t=>g(p)?p.value=t:null),title:"类型选择","show-cancel-button":"",onConfirm:S},{default:m(()=>[c("div",it,[r(z,{modelValue:s(_),"onUpdate:modelValue":o[1]||(o[1]=t=>g(_)?_.value=t:null),direction:"horizontal"},{default:m(()=>[r(B,{name:0},{default:m(()=>o[3]||(o[3]=[C("巡检单")])),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["show"])])}}},yt=W(lt,[["__scopeId","data-v-20bc90dc"]]);export{yt as default};
